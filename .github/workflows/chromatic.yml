name: "Chromatic"
on: push

jobs:
  chromatic-deployment:
    runs-on: ubuntu-latest
    steps:
        - uses: actions/checkout@v1
        - name: Install dependencies
          run: npm install
        - name: Installing dependencies in core
          working-directory: packages/core 
          run: npm install
        - name: Building @scania/tegl
          working-directory: packages/core 
          run: npm run build
        - name: Publish to Chromatic
          working-directory: packages/core 
          run: npx chromatic --project-token=${{secrets.CHROMATIC_PROJECT_TOKEN}}
        - name: Post status comment in PR
          uses: actions/github-script@v6
          if: always()
          with:
            script: |
              github.rest.issues.createComment({
                issue_number: context.issue.number,
                repo: context.repo.repo,
                body: 'Chromatic action completed âœ…'
              })