@import './_tl-dropdown_vars';
@import './_tl-dropdown_mixins';
@import '../tl-icon/tl-icon';
@import '../../../../../../typography/mixins/type-styles';

.tl-dropdown {
  display: block;
  min-width: 208px;
  position: relative;

  &::after {
    content: '';
    position: absolute;
    inset-block-start: 50%;
    inset-inline-end: var(--dropdown-icon-offset, var(--dropdown-spacing-inline));
    width: var(--dropdown-icon-size);
    height: var(--dropdown-icon-size);
    pointer-events: none;
    transform: translateY(-50%);
    background-color: var(--dropdown-icon);
    mask-image: var(--icon-chevron_down-svg);
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: contain;
    mask-image: var(--icon-chevron_down-svg);
    mask-repeat: no-repeat;
    mask-position: center;
    mask-size: contain;
  }

  &--no-min-width {
    min-width: auto;
  }

  &--disabled {
    pointer-events: none;
  }

  &--error:not(.tl-dropdown--disabled) {
    --dropdown-border: var(--dropdown-border-error);
    --dropdown-border-hover: var(--dropdown-border-error-hover);
    --dropdown-helper-text: var(--dropdown-error);
    --dropdown-bar-color: var(--dropdown-error);
    --dropdown-icon: var(--dropdown-error);
  }

  &--filter {
    --dropdown-icon-offset: var(--dropdown-spacing-8);

    .tl-dropdown__input {
      padding-right: calc(var(--dropdown-spacing-8) + var(--dropdown-icon-size));
    }
  }

  &--multiselect {
    .tl-dropdown__input {
      min-height: var(--dropdown-height-multiselect);
      height: auto;
    }
  }

  &--label-inside {
    position: relative;
  }

  &--lg {
    --dropdown-label-inside-top: var(--tds-spacing-element-16);
    --dropdown-spacing-inline: var(--tds-spacing-element-16);

    .tl-dropdown__input {
      @include tl-dropdown-size(56px, var(--dropdown-spacing-inline), 16px);
    }
  }

  &--md {
    --dropdown-label-inside-top: var(--tds-spacing-element-12);
    --dropdown-spacing-inline: var(--tds-spacing-element-16);

    .tl-dropdown__input {
      @include tl-dropdown-size(48px, var(--dropdown-spacing-inline), 16px);
    }
  }

  &--sm {
    --dropdown-label-inside-top: var(--tds-spacing-element-8);
    --dropdown-spacing-inline: var(--tds-spacing-element-12);

    .tl-dropdown__input {
      @include tl-dropdown-size(40px, var(--dropdown-spacing-inline), 14px);
    }
  }

  &--xs {
    --dropdown-label-inside-top: var(--tds-spacing-element-8);
    --dropdown-spacing-inline: var(--tds-spacing-element-8);

    .tl-dropdown__input {
      @include tl-dropdown-size(32px, var(--dropdown-spacing-inline), 12px);
    }
  }
}

.tl-dropdown__label {
  @include detail-05;

  color: var(--dropdown-text);
  display: block;
  margin-bottom: var(--dropdown-spacing-4);
}

.tl-dropdown--label-inside .tl-dropdown__label {
  position: absolute;
  pointer-events: none;
  transform-origin: top left;

  @include tl-dropdown-label-inside-position(
    var(--dropdown-label-inside-top),
    var(--dropdown-label-inside-left)
  );
}

.tl-dropdown__input {
  @include detail-02;

  width: 100%;
  appearance: none;
  background-color: var(--dropdown-background);
  color: var(--dropdown-text);
  border: none;
  border-radius: var(--dropdown-border-radius);
  box-shadow: var(--dropdown-border);
  cursor: pointer;
  padding: 0 var(--dropdown-spacing-inline);
  padding-right: calc(var(--dropdown-spacing-inline) + var(--dropdown-icon-size));

  @supports not (mask: url('')) {
    background-image: url("data:image/svg+xml,%3Csvg fill='none' height='24' width='24' stroke='currentColor' stroke-width='2' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--dropdown-icon-offset) center;
    background-size: var(--dropdown-icon-size);
  }

  &::placeholder {
    color: var(--dropdown-placeholder);
  }

  &:focus,
  &:focus-visible {
    @include tl-dropdown-focus-outline;
  }

  &:disabled {
    background-color: var(--dropdown-disabled);
    color: var(--dropdown-disabled);
  }

  option {
    color: var(--dropdown-option-text);
    background-color: var(--dropdown-option-background);
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    text-align: left;
    padding-inline: var(--dropdown-spacing-inline);
    padding-block: var(--dropdown-spacing-4);
  }

  option:checked,
  option[selected] {
    background-color: var(--dropdown-option-background-selected);
  }

  option:disabled {
    color: var(--dropdown-option-disabled);
    background-color: var(--dropdown-option-background);
  }

  option:hover {
    background-color: var(--dropdown-option-background-hover);
  }
}

.tl-dropdown:has(.tl-dropdown__input:focus):not(.tl-dropdown--disabled) .tl-dropdown__bar::after {
  transform: translateX(-50%) scaleX(1);
}

.tl-dropdown--disabled::after {
  background-color: var(--dropdown-disabled);
}

.tl-dropdown--disabled .tl-dropdown__bar::after {
  transform: scaleX(0) !important;
}

.tl-dropdown--placeholder .tl-dropdown__input {
  color: var(--dropdown-placeholder);
}

.tl-dropdown__bar {
  position: relative;
  width: 100%;
  height: 2px;
  z-index: 1;

  &::after {
    content: '';
    position: absolute;
    inset-block-end: 0;
    inset-inline-start: 50%;
    height: 2px;
    background-color: var(--dropdown-bar-color);
    inline-size: 100%;
    transform: translateX(-50%) scaleX(0);
    transform-origin: center;
    transition: transform 0.35s ease;
  }
}

.tl-dropdown__helper {
  @include detail-05;

  color: var(--dropdown-helper-text);
  padding-top: var(--dropdown-spacing-4);
  display: flex;
  gap: 8px;
  flex-basis: 100%;
}

.tl-dropdown__icon {
  display: none;
}
