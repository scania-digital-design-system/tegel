@import './tl-textarea-mixins';
@import './tl-textarea-vars';
@import '../../../../../../typography/mixins/type-styles';

.tl-textarea {
  padding-bottom: 1px;
  display: block;
  min-width: 208px;
  border-radius: var(--textarea-border-radius);
  position: relative;
  width: 100%;
  box-sizing: border-box;

  &--no-min-width {
    min-width: auto;
  }

  // Resize icon - always visible
  &::after {
    content: '';
    position: absolute;
    bottom: 2px;
    right: 2px;
    width: 12px;
    height: 12px;
    background-color: var(--textarea-resize-icon);
    mask-image: url("data:image/svg+xml,%3Csvg width='12' height='12' viewBox='0 0 12 12' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill-rule='evenodd' clip-rule='evenodd' d='M11.8536 0.853553C12.0488 0.658291 12.0488 0.341709 11.8536 0.146447C11.6583 -0.0488155 11.3417 -0.0488155 11.1464 0.146447L0.146447 11.1464C-0.0488155 11.3417 -0.0488155 11.6583 0.146447 11.8536C0.341709 12.0488 0.658291 12.0488 0.853553 11.8536L11.8536 0.853553ZM11.8536 4.64645C12.0488 4.84171 12.0488 5.15829 11.8536 5.35355L5.35355 11.8536C5.15829 12.0488 4.84171 12.0488 4.64645 11.8536C4.45118 11.6583 4.45118 11.3417 4.64645 11.1464L11.1464 4.64645C11.3417 4.45118 11.6583 4.45118 11.8536 4.64645ZM11.8536 8.64645C12.0488 8.84171 12.0488 9.15829 11.8536 9.35355L9.35355 11.8536C9.15829 12.0488 8.84171 12.0488 8.64645 11.8536C8.45118 11.6583 8.45118 11.3417 8.64645 11.1464L11.1464 8.64645C11.3417 8.45118 11.6583 8.45118 11.8536 8.64645Z' fill='currentColor'/%3E%3C/svg%3E");
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    pointer-events: none;
    z-index: 1;
  }

  // Readonly icon - only visible when readonly and not hidden
  &--readonly:not(&--disabled):not(&--hide-readonly-icon)::before {
    content: '';
    position: absolute;
    top: 18px;
    right: 18px;
    width: 20px;
    height: 20px;
    background-color: var(--textarea-text);
    mask-image: var(--icon-edit_inactive-svg);
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
    z-index: 1;
  }
}

.tl-textarea__input {
  @include textarea-base;
  @include detail-02;

  color: var(--textarea-text);
  padding: var(--tds-spacing-element-20) var(--tds-spacing-element-16);
  display: block;
  resize: vertical;
  box-shadow: inset var(--textarea-box-shadow);
  transition: box-shadow 0.2s;
  position: relative;
  z-index: 0;

  .tl-textarea:hover &:not(:focus) {
    box-shadow: inset var(--textarea-box-shadow-hover);
  }

  &:focus {
    box-shadow: inset var(--textarea-box-shadow-focus);
  }

  .tl-textarea--error & {
    box-shadow: inset var(--textarea-box-shadow-error);

    &:focus {
      box-shadow: inset var(--textarea-box-shadow-error-focus);
    }
  }

  .tl-textarea--error:hover &:not(:focus) {
    box-shadow: inset var(--textarea-box-shadow-error-hover);
  }

  .tl-textarea--success:not(.tl-textarea--readonly):not(.tl-textarea--disabled) &:not(:focus) {
    box-shadow: inset var(--textarea-box-shadow-success);
  }

  .tl-textarea--disabled & {
    box-shadow: none;
    background-color: var(--textarea-background-disabled);
  }

  .tl-textarea--label-inside & {
    padding-top: var(--tds-spacing-element-24);
    padding-bottom: 15px;
  }

  &::-webkit-resizer {
    display: none;
  }

  .tl-textarea--readonly:not(.tl-textarea--disabled):not(.tl-textarea--hide-readonly-icon) & {
    padding-right: 54px;
  }
}

.tl-textarea__label {
  .tl-textarea--label-outside & {
    @include detail-05;

    display: block;
    margin-bottom: var(--tds-spacing-element-8);
    color: var(--textarea-label);
  }

  .tl-textarea--label-inside & {
    @include detail-02;

    position: absolute;
    pointer-events: none;
    color: var(--textarea-label-inside);
    left: var(--textarea-label-inside-left, 16px);
    transition: transform 0.15s, font-size 0.15s, color 0.15s, top 0.15s;
    transform-origin: top left;
    z-index: 1;
    top: 50%;
    transform: translateY(-50%);
  }
}

.tl-textarea__helper {
  @include detail-05;

  color: var(--textarea-helper);
  padding-top: 4px;
  display: flex;
  gap: 8px;
  position: relative;

  .tl-textarea--disabled & {
    color: var(--color-foreground-text-disabled);
  }

  .tl-textarea--error &::before {
    content: '';
    position: absolute;
    left: 0;
    top: 4px;
    width: 16px;
    height: 16px;
    background-color: var(--textarea-error);
    mask-image: var(--icon-info-svg);
    mask-size: contain;
    mask-repeat: no-repeat;
    mask-position: center;
  }

  .tl-textarea--error.tl-textarea--disabled &::before {
    background-color: var(--color-foreground-text-disabled);
  }

  .tl-textarea--error & {
    padding-left: 24px;
  }
}

.tl-textarea__textcounter {
  @include detail-05;

  color: var(--textarea-textcounter);
  margin-left: auto;
}

// Focus/input state - label goes up and becomes smaller
@include focus-input-state {
  @include detail-07;

  top: 12.5px;
  transform: none;
}

// Placeholder should always be transparent when label-inside is used
.tl-textarea--label-inside .tl-textarea__input::placeholder {
  color: transparent;
}

// Disabled state - modifier styles in affected elements
.tl-textarea--disabled {
  pointer-events: none;
}

.tl-textarea__label,
.tl-textarea__helper {
  .tl-textarea--disabled & {
    color: var(--textarea-label-disabled);
  }
}

.tl-textarea__textcounter {
  .tl-textarea--disabled & {
    color: var(--color-foreground-text-disabled);
  }
}

.tl-textarea__label {
  .tl-textarea--disabled.tl-textarea--label-inside & {
    @include detail-07;

    top: 8px;
    transform: translateY(0);
  }
}

.tl-textarea__input::placeholder {
  .tl-textarea--disabled.tl-textarea--label-inside & {
    color: var(--textarea-placeholder) !important;
  }
}

// Read only state - modifier styles in affected elements
.tl-textarea--readonly .tl-textarea__input {
  user-select: auto;
  caret-color: transparent;
  cursor: default;
}

.tl-textarea__icon-readonly {
  .tl-textarea--readonly & {
    display: block;

    &:hover ~ .tl-textarea__icon-readonly-label {
      display: block;
    }
  }
}

// Error state - modifier styles for helper text
.tl-textarea__helper,
.tl-textarea__textcounter {
  .tl-textarea--error:not(.tl-textarea--readonly):not(.tl-textarea--disabled) & {
    color: var(--textarea-error);
  }
}
